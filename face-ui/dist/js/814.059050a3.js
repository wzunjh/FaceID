"use strict";(self["webpackChunkface_id"]=self["webpackChunkface_id"]||[]).push([[814],{27814:(e,t,a)=>{a.r(t),a.d(t,{default:()=>d});var i=function(){var e=this,t=e._self._c;return t("div",[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-card",{attrs:{header:"我的登录人脸信息"}},[t("el-form",{attrs:{inline:!0}},[t("el-form-item",{attrs:{label:"人脸名称"}},[t("el-input",{attrs:{placeholder:"名称",clearable:""},model:{value:e.searchFace.faceName,callback:function(t){e.$set(e.searchFace,"faceName",t)},expression:"searchFace.faceName"}})],1),t("el-form-item",{attrs:{label:"人脸状态"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.searchFace.faceStatus,callback:function(t){e.$set(e.searchFace,"faceStatus",t)},expression:"searchFace.faceStatus"}},[t("el-option",{attrs:{label:"不限",value:""}}),t("el-option",{attrs:{label:"启用",value:"0"}}),t("el-option",{attrs:{label:"禁用",value:"1"}})],1)],1),t("el-form-item",[t("el-button",{attrs:{icon:"el-icon-search"},on:{click:e.getFaceList}},[e._v("搜索")])],1)],1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-card",[t("el-header",{staticStyle:{"background-color":"#ffffff"}},[e.isSuperUser?t("el-button",{attrs:{icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.handleSave()}}},[e._v("添加人脸")]):e._e()],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[t("el-table-column",{attrs:{width:"100",prop:"fid",label:"编号",sortable:""}}),t("el-table-column",{attrs:{width:"150",prop:"date",label:"人脸图片"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{icon:"el-icon-picture-outline",size:"mini"},on:{click:function(t){return e.selectImg(a.row.faceBase)}}},[e._v("查看人脸")])]}}])}),t("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"200",sortable:""}}),t("el-table-column",{attrs:{prop:"vefNum",label:"登录验证次数",sortable:""}}),t("el-table-column",{attrs:{prop:"faceName",label:"姓名"}}),t("el-table-column",{attrs:{prop:"apiMin",label:"API次数/Min"}}),t("el-table-column",{attrs:{prop:"remark",label:"备注"}}),t("el-table-column",{attrs:{prop:"faceStatus",label:"是否启用",sortable:""},scopedSlots:e._u([{key:"default",fn:function(e){return[t("el-switch",{attrs:{value:0===e.row.faceStatus,"active-color":"#13ce66","inactive-color":"#ff4949"}})]}}])}),t("el-table-column",{attrs:{label:"操作",width:"230"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{icon:"el-icon-edit",size:"mini"},on:{click:function(t){return e.handleEdit(a.$index,a.row)}}},[e._v("编辑")]),t("el-popconfirm",{attrs:{title:"确认删除"+a.row.faceName+"的人脸数据吗?"},on:{confirm:function(t){return e.handleDelete(a.$index,a.row)}}},[e.isSuperUser?t("el-button",{staticStyle:{"margin-left":"20px"},attrs:{slot:"reference",icon:"el-icon-delete",size:"mini",type:"danger"},slot:"reference"},[e._v("删除")]):e._e()],1)]}}])})],1)],1)],1)],1),t("el-row",{staticClass:"page-row"},[t("el-pagination",{staticClass:"el-pagination",attrs:{layout:"total, sizes, prev, pager, next, jumper","page-sizes":[5,10,30,50],"current-page":e.current,"page-size":e.size,total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:"人脸图片",visible:e.selectImgDialog,width:"30%"},on:{"update:visible":function(t){e.selectImgDialog=t}}},[t("img",{staticStyle:{width:"100%"},attrs:{src:e.currentImg}})]),t("el-dialog",{attrs:{title:e.saveAndUpdateTitle,visible:e.saveAndUpdateDialog,"before-close":e.handleClose,width:"600px"},on:{"update:visible":function(t){e.saveAndUpdateDialog=t}}},[t("el-form",{ref:"ruleForm",attrs:{model:e.faceObj,rules:e.rules,"label-width":"80px"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.faceObj.fid,expression:"faceObj.fid"}],attrs:{type:"hidden"},domProps:{value:e.faceObj.fid},on:{input:function(t){t.target.composing||e.$set(e.faceObj,"fid",t.target.value)}}}),t("el-form-item",{attrs:{label:"人脸名称",prop:"faceName"}},[t("el-input",{attrs:{placeholder:"必填项"},model:{value:e.faceObj.faceName,callback:function(t){e.$set(e.faceObj,"faceName",t)},expression:"faceObj.faceName"}})],1),t("el-form-item",{staticStyle:{"margin-bottom":"30px"},attrs:{label:"人脸状态",prop:"faceStatus"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.faceObj.faceStatus,callback:function(t){e.$set(e.faceObj,"faceStatus",t)},expression:"faceObj.faceStatus"}},[t("el-option",{attrs:{label:"启用",value:0}}),t("el-option",{attrs:{label:"禁用",value:1}})],1)],1),t("el-form-item",{staticClass:"login-mid-mid",attrs:{label:"人脸数据",prop:"faceBase"}},[t("div",{staticClass:"savevideoCamera-canvasCamera"},[t("video",{attrs:{id:"videoCamera2",width:e.videoWidth,height:e.videoHeight,autoplay:""}}),t("canvas",{staticStyle:{display:"none"},attrs:{id:"canvasCamera2",width:e.videoWidth,height:e.videoHeight}}),e.faceImgState?t("div",{staticClass:"saveface-special-effects-2"}):t("div",{staticClass:"saveface-special-effects"}),t("el-input",{attrs:{type:"hidden"},model:{value:e.faceObj.faceBase,callback:function(t){e.$set(e.faceObj,"faceBase",t)},expression:"faceObj.faceBase"}})],1),t("div",{staticClass:"savefaceBase",attrs:{id:"faceBase"}}),e.cameraState?t("div",{staticClass:"saveface-btn"},[t("el-button",{on:{click:e.enteringFace}},[e._v(e._s(""===e.faceObj.faceBase?"录入人脸":"重新录入"))])],1):t("div",{staticClass:"saveface-btn"},[t("el-button",[e._v("摄像头正在加载...")])],1)]),t("el-form-item",{attrs:{label:"次数/分钟"}},[t("el-input",{attrs:{placeholder:"必填",type:"textarea"},model:{value:e.faceObj.apiMin,callback:function(t){e.$set(e.faceObj,"apiMin",t)},expression:"faceObj.apiMin"}})],1),t("el-form-item",{attrs:{label:"备注"}},[t("el-input",{attrs:{placeholder:"非必填",type:"textarea"},model:{value:e.faceObj.remark,callback:function(t){e.$set(e.faceObj,"remark",t)},expression:"faceObj.remark"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("立即创建")]),t("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1)],1)},s=[],l=(a(32564),a(91058),a(57327),a(41539),a(81087));const c={data:function(){return{size:5,current:1,total:0,videoWidth:200,videoHeight:200,faceImgState:!1,searchFace:{faceName:"",faceStatus:""},tableData:[],selectImgDialog:!1,currentImg:"",saveAndUpdateDialog:!1,saveAndUpdateTitle:"",faceObj:{fid:null,faceName:"",faceBase:"",faceStatus:0,remark:"",apiMin:5,addAndUpdateState:!1},rules:{faceName:[{required:!0,message:"请输入人脸名称",trigger:"blur"},{min:2,max:5,message:"长度在 2 到 5 个字符",trigger:"blur"}],faceBase:[{required:!0,message:"人脸数据不能为空"}]},faceOption:{},cameraState:!1,currentUserFid:null}},computed:{isSuperUser:function(){return 1===this.currentUserFid}},watch:{saveAndUpdateDialog:{handler:function(e,t){var a=this;if(e)setTimeout((function(){a.faceOption=l.Z.getCamera({videoWidth:200,videoHeight:200,thisCancas:null,thisContext:null,thisVideo:null,canvasId:"canvasCamera2",videoId:"videoCamera2"})}),1e3);else{var i=document.getElementById("faceBase");i.innerHTML="",null!=this.faceOption.thisVideo&&this.faceOption.thisVideo.srcObject.getTracks()[0].stop()}}}},created:function(){this.currentUserFid=parseInt(localStorage.getItem("user_id")),this.getFaceList()},methods:{enteringFace:function(){this.faceObj.faceBase=l.Z.draw(this.faceOption);var e=document.getElementById("faceBase");e.innerHTML="<img src='"+this.faceObj.faceBase+"' />"},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.$http.post("/face/"+(t.addAndUpdateState?"save":"update"),t.faceObj).then((function(e){t.$message({showClose:!0,message:e.data.msg,type:"success",duration:3e3}),t.getFaceList(),t.saveAndUpdateDialog=!1}))}))},resetForm:function(e){var t=document.getElementById("faceBase");t.innerHTML="",this.$refs[e].resetFields()},selectImg:function(e){this.selectImgDialog=!0,this.currentImg=e},getFaceList:function(){var e=this,t={current:this.current,size:this.size,faceName:this.searchFace.faceName,faceStatus:this.searchFace.faceStatus};this.$http.get("/face/faceList",{params:t}).then((function(t){var a=t.data.data.records;1!==e.currentUserFid?(a=a.filter((function(t){return t.fid===e.currentUserFid})),e.total=a.length):e.total=t.data.data.total,e.tableData=a,e.size=t.data.data.size,e.current=t.data.data.current}))},handleSizeChange:function(e){this.size=e,this.getFaceList()},handleCurrentChange:function(e){this.current=e,this.getFaceList()},handleClose:function(){this.saveAndUpdateDialog=!1,this.cameraState=!1,this.resetForm("ruleForm")},setCameraState:function(){var e=this;setTimeout((function(){e.cameraState=!0}),1500)},handleSave:function(){this.setCameraState(),this.addAndUpdateState=!0,this.saveAndUpdateDialog=!0,this.saveAndUpdateTitle="添加人脸"},handleEdit:function(e,t){var a=this;this.setCameraState(),this.addAndUpdateState=!1,this.saveAndUpdateDialog=!0,this.saveAndUpdateTitle="修改人脸",this.$http.get("/face/info/"+t.fid).then((function(e){a.faceObj=e.data.data;var t=document.getElementById("faceBase");t.innerHTML="<img src='"+a.faceObj.faceBase+"' />"}))},handleDelete:function(e,t){var a=this;this.$http.get("/face/faceDelete/"+t.fid).then((function(e){a.getFaceList(),a.$message.success(e.data.msg)}))}}},r=c;var n=a(1001),o=(0,n.Z)(r,i,s,!1,null,null,null);const d=o.exports}}]);
//# sourceMappingURL=814.059050a3.js.map